@using RpgRooms.Core.Domain.Entities
<div class="rpg-section">
  <h4>Perícias</h4>
  @foreach (var skill in skills)
  {
      var proficient = Character.SkillProficiencies.Any(p => p.Name == skill.Name);
      <div>
          @if(!IsReadOnly)
          {
              <input type="checkbox" checked="@proficient" @onchange="e => Toggle(skill.Name, (bool)e.Value)" />
          }
          <span>@skill.Display (@Character.GetSkillValue(skill.Name))</span>
      </div>
  }
</div>

@code {
  [Parameter] public Character Character { get; set; } = default!;
  [Parameter] public bool IsReadOnly { get; set; }

  record Skill(string Name, string Display);
  Skill[] skills = new[] {
      new Skill("Acrobacia","Acrobacia (DEX)"),
      new Skill("Arcanismo","Arcanismo (INT)"),
      new Skill("Atletismo","Atletismo (STR)"),
      new Skill("História","História (INT)"),
      new Skill("Furtividade","Furtividade (DEX)"),
      new Skill("Sobrevivência","Sobrevivência (WIS)")
  };
  void Toggle(string name, bool value)
  {
      var prof = Character.SkillProficiencies.FirstOrDefault(p => p.Name == name);
      if (value && prof == null) Character.SkillProficiencies.Add(new SkillProficiency { Name = name });
      if (!value && prof != null) Character.SkillProficiencies.Remove(prof);
  }
}
